{% extends "base.html" %}
{% load mathfilters %}

{% block title %}
Login_Page
{% endblock %}
{% block stylesheet %}
{% load static %}
<link href="{% static 'css/login.css' %}" rel="stylesheet">
{% endblock %}


{% block nav %}
{% endblock %}

{% block contents %}

<div id="wrap">
    <div id="container">
        <!-- 로그인 시작 -->
        <div class="login_box">
            <div class="login_wrap">
                <form name="login" action="{%url 'member_login' %}" method="POST" id="login_input">
                    {% csrf_token %}
                    <div class="input-group flex-nowrap">
                        <span class="input-group-text" id="addon-wrapping">ID</span>
                        <input type="text" class="id_input" name="username" placeholder="ID를 입력하세요.">
                    </div>
                    <div class="input-group flex-nowrap">
                        <span class="input-group-text" id="addon-wrapping">PW</span>
                        <input type="text" class="pw_input" name="password" placeholder="Password를 입력하세요.">
                    </div>
                    <div>
                        <input type="submit" class="btn btn-primary w-100" value="Login">
                    </div>
                    <div>
                        <span style="color:red;"><strong>{{ error }}</strong> </span>
                    </div>
                </form>
                <br>
                <div style="clear: both;"></div>
                <div class="login_list">
                    <a href="#" class="kakao">
                        <div class="kakao">
                            <strong>카카오로그인</strong>
                        </div>
                    </a>
                    <a href="#" class="naver">
                        <div class="naver" id="naverIdLogin_loginButton">
                            <strong>네이버로그인</strong>
                        </div>
                    </a>
                    <a href="#" class="Apple">
                        <div class="Apple">
                            <strong>Apple로그인</strong>
                        </div>
                    </a>
                </div>
                <div class="sub_find">
                    <a href="#" id="myBtn1" data-target="#myModal" data-toggle="modal">아이디 찾기 <small>|</small></a>
                    <a href="#" id="myBtn2" data-target="#myModal" data-toggle="modal">비밀번호 찾기 <small>|</small></a>
                    <a href="{% url 'member_terms' %}" style="text-decoration: none;">회원가입</a>
                </div>
            </div>

            <div id="myModal1" class="modal1">
                <div class="modal-content">
                    <div class="find_id">아이디 찾기</div>
                    <div class="col-2 close1">&times;</div>
                    <div class="menu">
                        <div class="faq-content">
                            <button class="question" id="que-1"><span>등록된 휴대폰번호로 찾기</span><span
                                    id="que-1-toggle">∨</span></button>
                            <div class="answer" id="ans-1">
                                <form action="{% url 'member_findusername' %}" method="POST">
                                {% csrf_token %}
                                    <div><input type="text" class="ininput" name="name" id="name" placeholder="이름을 입력하세요" required></div>
                                    <div><input type="text" class="ininput" name="phoneNum" id="phoneNum" placeholder="휴대폰 번호를 입력하세요"required></div>
                                    <button type="submit" class="btn btn-secondary btnn"
                                        style="background-color: rgb(119, 118, 177)">아이디 찾기</button>
                                </form>
                            </div>
                        </div>
                        <div class="faq-content">
                            <button class="question" id="que-2"><span>등록된 이메일로 찾기</span><span
                                    id="que-2-toggle">∨</span></button>
                            <div class="answer" id="ans-2">
                                <form action="{% url 'member_findusername' %}" method="POST">
                                {% csrf_token %}
                                    <div><input type="text" class="ininput" name="name" id="name" placeholder="이름을 입력하세요" required></div>
                                    <div><input type="text" class="ininput" name="email" id="email" placeholder="이메일을 입력하세요" required></div>
                                    <button type="submit" class="btn btn-secondary btnn"
                                        style="background-color: rgb(119, 118, 177)">아이디 찾기</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="myModal2" class="modal2">
                <div class="modal-content">
                    <div class="find_id">비밀번호 찾기</div>
                    <div class="col-2 close2">&times;</div>
                    <div class="menu">
                        <div class="faq-content">
                            <button class="questionq" id="queq-1"><span>등록된 휴대폰번호로 찾기</span><span
                                    id="queq-1-toggle">∨</span></button>
                            <div class="answer" id="ansq-1">
                                <form action="{% url 'member_findpw' %}" method="POST">
                                    {% csrf_token %}
                                    <div><input type="text" class="ininput" name="username" id="username" placeholder="아이디를 입력하세요" required></div>
                                    <div><input type="text" class="ininput" name="name" id="name" placeholder="이름을 입력하세요" required></div>
                                    <div><input type="text" class="ininput" name="phoneNum" id="phoneNum" placeholder="휴대폰 번호를 입력하세요" required></div>
                                    <button type="submit" class="btn btn-secondary btnn"
                                        style="background-color: rgb(119, 118, 177)">비밀번호 찾기</button>
                                </form>
                            </div>
                        </div>
                        <div class="faq-content">
                            <button class="questionq" id="queq-2"><span>등록된 이메일로 찾기</span><span
                                    id="queq-2-toggle">∨</span></button>
                            <div class="answer" id="ansq-2">
                                <form action="{% url 'member_findpw' %}" method="POST">
                                    {% csrf_token %}
                                    <div><input type="text" class="ininput" name="username" id="username" placeholder="아이디을 입력하세요" required></div>
                                    <div><input type="text" class="ininput" name="name" id="name" placeholder="이름을 입력하세요" required></div>
                                    <div><input type="text" class="ininput" name="email" id="email" placeholder="이메일을 입력하세요" required></div>
                                    <button type="submit" class="btn btn-secondary btnn"
                                        style="background-color: rgb(119, 118, 177)">비밀번호 찾기</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
<!-- footer 시작 -->
<footer>

</footer>
<!-- footer 끝 -->
<script src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js" charset="utf-8"></script>
<script>
    var modal1 = document.getElementById("myModal1");
    var modal2 = document.getElementById("myModal2");
    var btn1 = document.getElementById("myBtn1");
    var btn2 = document.getElementById("myBtn2");
    var span1 = document.getElementsByClassName("close1")[0];
    var span2 = document.getElementsByClassName("close2")[0];

    btn1.onclick = function () {
        modal1.style.display = "block";
    }
    btn2.onclick = function () {
        modal2.style.display = "block";
    }
    span1.onclick = function () {
        modal1.style.display = "none";
        document.getElementById('ans-1').style.display = 'none';
        document.getElementById('que-1-toggle').textContent = '∨';
        document.getElementById('ans-2').style.display = 'none';
        document.getElementById('que-2-toggle').textContent = '∨';
    }
    span2.onclick = function () {
        modal2.style.display = "none";
        document.getElementById('ansq-1').style.display = 'none';
        document.getElementById('queq-1-toggle').textContent = '∨';
        document.getElementById('ansq-2').style.display = 'none';
        document.getElementById('queq-2-toggle').textContent = '∨';
    }
    window.onclick = function (event) {
        if (event.target == modal1) {
            modal1.style.display = "none";
            document.getElementById('ans-1').style.display = 'none';
            document.getElementById('que-1-toggle').textContent = '∨';
            document.getElementById('ans-2').style.display = 'none';
            document.getElementById('que-2-toggle').textContent = '∨';
        }
        if (event.target == modal2) {
            modal2.style.display = "none";
            document.getElementById('ansq-1').style.display = 'none';
            document.getElementById('queq-1-toggle').textContent = '∨';
            document.getElementById('ansq-2').style.display = 'none';
            document.getElementById('queq-2-toggle').textContent = '∨';
        }
    }


    const items = document.querySelectorAll('.question');

    function openCloseAnswer() {
        const answerId = this.id.replace('que', 'ans');

        if (document.getElementById(answerId).style.display === 'block') {
            document.getElementById(answerId).style.display = 'none';
            document.getElementById(this.id + '-toggle').textContent = '∨';
        } else {
            document.getElementById(answerId).style.display = 'block';
            document.getElementById(this.id + '-toggle').textContent = '∧';
        }
    }
    items.forEach(item => item.addEventListener('click', openCloseAnswer));

    const itemss = document.querySelectorAll('.questionq');

    function openCloseAnswerq() {
        const answerId = this.id.replace('queq', 'ansq');
        if (document.getElementById(answerId).style.display === 'block') {
            document.getElementById(answerId).style.display = 'none';
            document.getElementById(this.id + '-toggle').textContent = '∨';
        } else {
            document.getElementById(answerId).style.display = 'block';
            document.getElementById(this.id + '-toggle').textContent = '∧';
        }
    }
    itemss.forEach(item => item.addEventListener('click', openCloseAnswerq));
</script>

<script>

    var naverLogin = new naver.LoginWithNaverId(
            {
                clientId: "1Go9cVzNHoC3yswLKLwt", //내 애플리케이션 정보에 cliendId를 입력해줍니다.
                callbackUrl: "http://127.0.0.1:8000/", // 내 애플리케이션 API설정의 Callback URL 을 입력해줍니다.
                isPopup: false,
                callbackHandle: true
            }
        );	
    
    naverLogin.init();
    
    window.addEventListener('load', function () {
        naverLogin.getLoginStatus(function (status) {
            if (status) {
                var email = naverLogin.user.getEmail(); 
                var gender = naverLogin.user.getGender(); 
                var name = naverLogin.user.getName(); 
                var birthday = naverLogin.user.getBirthday(); 
                var mobile = naverLogin.user.getMobile(); 
                
                console.log(naverLogin.user); 
                
                if( email == undefined || email == null) {
                    alert("이메일은 필수정보입니다. 정보제공을 동의해주세요.");
                    naverLogin.reprompt();
                    return;
                }
                if( gender == undefined || gender == null) {
                    alert("성별은 필수정보입니다. 정보제공을 동의해주세요.");
                    naverLogin.reprompt();
                    return;
                }
                if( name == undefined || name == null) {
                    alert("이름은 필수정보입니다. 정보제공을 동의해주세요.");
                    naverLogin.reprompt();
                    return;
                }
                if( birthday == undefined || birthday == null) {
                    alert("생년월일은 필수정보입니다. 정보제공을 동의해주세요.");
                    naverLogin.reprompt();
                    return;
                }
                if( mobile == undefined || mobile == null) {
                    alert("전화번호은 필수정보입니다. 정보제공을 동의해주세요.");
                    naverLogin.reprompt();
                    return;
                }
            } else {
                console.log("callback 처리에 실패하였습니다.");
            }
        });
    });
    
    
    var testPopUp;
    function openPopUp() {
        testPopUp= window.open("https://nid.naver.com/nidlogin.logout", "_blank", "toolbar=yes,scrollbars=yes,resizable=yes,width=1,height=1");
    }
    function closePopUp(){
        testPopUp.close();
    }
    
    function naverLogout() {
	openPopUp();
	setTimeout(function() {
		closePopUp();
		}, 1000);
	
	function naverSignInCallback() {
        alert(naverLogin.getProfileData('email'));
        alert(naverLogin.getProfileData('age'));
        alert(naverLogin.getProfileData('mobile'));
    }
}
        
    
</script>


{% endblock %}